2026-02-09T17:02:18.846386+09:00 DEBUG replited::cmd::replicate: replicate.rs:38 Checking replicate: StorageConfig { name: "stream-server", params: Stream(StorageStreamConfig { addr: "http://0.0.0.0:50051", remote_db_name: None }) }
2026-02-09T17:02:18.846455+09:00 DEBUG replited::cmd::replicate: replicate.rs:41 Found stream config: StorageStreamConfig { addr: "http://0.0.0.0:50051", remote_db_name: None }
2026-02-09T17:02:18.846397+09:00  INFO replited::database::database::init: init.rs:101 start database with config: ReplicateDbConfig { db: "data.db", storage: [StorageConfig { name: "stream-server", params: Stream(StorageStreamConfig { addr: "http://0.0.0.0:50051", remote_db_name: None }) }], min_checkpoint_page_number: 1000, max_checkpoint_page_number: 10000, truncate_page_number: 500000, checkpoint_interval_secs: 60, monitor_interval_ms: 1000, apply_checkpoint_frame_interval: 128, apply_checkpoint_interval_ms: 2000, wal_retention_count: 10 }

2026-02-09T17:02:18.846490+09:00  INFO replited::database::database::init: init.rs:102 CWD: Ok("/Users/cypark/Documents/project/replited")
2026-02-09T17:02:18.846496+09:00  INFO replited::database::database::init: init.rs:103 Opening connection to data.db
2026-02-09T17:02:18.846500+09:00 DEBUG replited::database::database::init: init.rs:104 Database::try_create opening connection
2026-02-09T17:02:18.846652+09:00 DEBUG replited::database::database::init: init.rs:106 Database::try_create connection opened
2026-02-09T17:02:18.846657+09:00  INFO replited::database::database::init: init.rs:108 Initializing params
2026-02-09T17:02:18.846781+09:00 DEBUG replited::sync::server: server.rs:75 Primary: journal_mode WAL busy/locked for data.db while opening pin connection: database is locked
2026-02-09T17:02:18.846787+09:00 DEBUG replited::sync::server: server.rs:89 Primary: Opened persistent connection for data.db
2026-02-09T17:02:18.846794+09:00  INFO replited::cmd::replicate: replicate.rs:71 Starting ReplicationServer at 0.0.0.0:50051
2026-02-09T17:02:18.846809+09:00  INFO replited::cmd::replicate: replicate.rs:73 ReplicationServer serving at 0.0.0.0:50051
2026-02-09T17:02:18.848355+09:00  INFO replited::database::database::init: init.rs:111 Creating internal tables
2026-02-09T17:02:18.848796+09:00  INFO replited::database::database::init: init.rs:118 Initializing directory
2026-02-09T17:02:18.848800+09:00 DEBUG replited::database::database::init: init.rs:119 Database::try_create init directory
2026-02-09T17:02:18.848815+09:00  INFO replited::database::database::init: init.rs:94 Creating meta dir at: "/Users/cypark/Documents/project/replited/./.data.db-replited/"
2026-02-09T17:02:18.848821+09:00 DEBUG replited::database::database::init: init.rs:121 Database::try_create meta_dir: ./.data.db-replited/
2026-02-09T17:02:18.848830+09:00  INFO replited::database::database::init: init.rs:172 Acquiring read lock
2026-02-09T17:02:18.850289+09:00 DEBUG replited::database::database::init: init.rs:177 db data.db cannot determine last wal position, error: MismatchWalHeaderError. Code: 85, Text = db data.db wal header mismatched.

<Backtrace disabled by default. Please use RUST_BACKTRACE=1 to enable> , clearing generation
2026-02-09T17:02:19.852480+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:19.852994+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 00000000-0000-0000-0000-000000000000, generation: "" }, db_mod_time: None, wal_size: 0, shadow_wal_file: "", shadow_wal_size: 0, reason: Some("no generation exists"), restart: false }
2026-02-09T17:02:19.855703+09:00 DEBUG replited::database::database: database.rs:574 init_shadow_wal_file ./.data.db-replited/generations/019c416c424d7cc085267a42f9b74cba/wal/0000000000.wal
2026-02-09T17:02:19.856494+09:00 DEBUG replited::database::database: database.rs:603 create shadow wal file ./.data.db-replited/generations/019c416c424d7cc085267a42f9b74cba/wal/0000000000.wal
2026-02-09T17:02:19.856855+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 16512,  orig_shadow_wal_size: 32
2026-02-09T17:02:19.858300+09:00 DEBUG replited::database::database: database.rs:607 db data.db init_shadow_wal_file copy_to_shadow_wal: 16512, 16512
2026-02-09T17:02:19.859708+09:00  INFO replited::database::database: database.rs:532 db data.db retention generation 019c416c424d7cc085267a42f9b74cba floor 0 tail 0 active_replicas 0
2026-02-09T17:02:19.859956+09:00  INFO replited::database::database: database.rs:202 db data.db sync new generation: 019c416c424d7cc085267a42f9b74cba, reason: no generation exists
2026-02-09T17:02:19.860108+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 16512,  orig_shadow_wal_size: 16512
2026-02-09T17:02:19.860201+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 16512, 16512
2026-02-09T17:02:19.860210+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 16512:16512
2026-02-09T17:02:19.860458+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:20.862661+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:20.863859+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 019c416c-424d-7cc0-8526-7a42f9b74cba, generation: "019c416c424d7cc085267a42f9b74cba" }, db_mod_time: Some(SystemTime { tv_sec: 1770624138, tv_nsec: 848251184 }), wal_size: 16512, shadow_wal_file: "./.data.db-replited/generations/019c416c424d7cc085267a42f9b74cba/wal/0000000000.wal", shadow_wal_size: 16512, reason: None, restart: false }
2026-02-09T17:02:20.865478+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 16512,  orig_shadow_wal_size: 16512
2026-02-09T17:02:20.865631+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 16512, 16512
2026-02-09T17:02:20.865709+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 16512:16512
2026-02-09T17:02:20.866064+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:21.868081+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:21.868998+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 019c416c-424d-7cc0-8526-7a42f9b74cba, generation: "019c416c424d7cc085267a42f9b74cba" }, db_mod_time: Some(SystemTime { tv_sec: 1770624138, tv_nsec: 848251184 }), wal_size: 16512, shadow_wal_file: "./.data.db-replited/generations/019c416c424d7cc085267a42f9b74cba/wal/0000000000.wal", shadow_wal_size: 16512, reason: None, restart: false }
2026-02-09T17:02:21.870160+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 16512,  orig_shadow_wal_size: 16512
2026-02-09T17:02:21.870419+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 16512, 16512
2026-02-09T17:02:21.870493+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 16512:16512
2026-02-09T17:02:21.871014+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:22.875121+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:22.878290+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 019c416c-424d-7cc0-8526-7a42f9b74cba, generation: "019c416c424d7cc085267a42f9b74cba" }, db_mod_time: Some(SystemTime { tv_sec: 1770624138, tv_nsec: 848251184 }), wal_size: 16512, shadow_wal_file: "./.data.db-replited/generations/019c416c424d7cc085267a42f9b74cba/wal/0000000000.wal", shadow_wal_size: 16512, reason: None, restart: false }
2026-02-09T17:02:22.882438+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 16512,  orig_shadow_wal_size: 16512
2026-02-09T17:02:22.882660+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 16512, 16512
2026-02-09T17:02:22.882816+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 16512:16512
2026-02-09T17:02:22.883690+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:23.885922+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:23.886525+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 019c416c-424d-7cc0-8526-7a42f9b74cba, generation: "019c416c424d7cc085267a42f9b74cba" }, db_mod_time: Some(SystemTime { tv_sec: 1770624138, tv_nsec: 848251184 }), wal_size: 28872, shadow_wal_file: "./.data.db-replited/generations/019c416c424d7cc085267a42f9b74cba/wal/0000000000.wal", shadow_wal_size: 16512, reason: None, restart: false }
2026-02-09T17:02:23.887283+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 28872,  orig_shadow_wal_size: 16512
2026-02-09T17:02:23.888510+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 28872, 28872
2026-02-09T17:02:23.888531+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 28872:28872
2026-02-09T17:02:23.888876+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:24.903214+09:00  INFO replited::database::database::init: init.rs:101 start database with config: ReplicateDbConfig { db: "data.db", storage: [StorageConfig { name: "stream-server", params: Stream(StorageStreamConfig { addr: "http://0.0.0.0:50051", remote_db_name: None }) }], min_checkpoint_page_number: 1000, max_checkpoint_page_number: 10000, truncate_page_number: 500000, checkpoint_interval_secs: 60, monitor_interval_ms: 1000, apply_checkpoint_frame_interval: 128, apply_checkpoint_interval_ms: 2000, wal_retention_count: 10 }

2026-02-09T17:02:24.903196+09:00 DEBUG replited::cmd::replicate: replicate.rs:38 Checking replicate: StorageConfig { name: "stream-server", params: Stream(StorageStreamConfig { addr: "http://0.0.0.0:50051", remote_db_name: None }) }
2026-02-09T17:02:24.903296+09:00 DEBUG replited::cmd::replicate: replicate.rs:41 Found stream config: StorageStreamConfig { addr: "http://0.0.0.0:50051", remote_db_name: None }
2026-02-09T17:02:24.903313+09:00  INFO replited::database::database::init: init.rs:102 CWD: Ok("/Users/cypark/Documents/project/replited")
2026-02-09T17:02:24.903358+09:00  INFO replited::database::database::init: init.rs:103 Opening connection to data.db
2026-02-09T17:02:24.903371+09:00 DEBUG replited::database::database::init: init.rs:104 Database::try_create opening connection
2026-02-09T17:02:24.903737+09:00 DEBUG replited::database::database::init: init.rs:106 Database::try_create connection opened
2026-02-09T17:02:24.903751+09:00  INFO replited::database::database::init: init.rs:108 Initializing params
2026-02-09T17:02:24.904094+09:00 DEBUG replited::sync::server: server.rs:89 Primary: Opened persistent connection for data.db
2026-02-09T17:02:24.904098+09:00  INFO replited::database::database::init: init.rs:111 Creating internal tables
2026-02-09T17:02:24.904111+09:00  INFO replited::cmd::replicate: replicate.rs:71 Starting ReplicationServer at 0.0.0.0:50051
2026-02-09T17:02:24.904126+09:00  INFO replited::database::database::init: init.rs:118 Initializing directory
2026-02-09T17:02:24.904132+09:00 DEBUG replited::database::database::init: init.rs:119 Database::try_create init directory
2026-02-09T17:02:24.904132+09:00  INFO replited::cmd::replicate: replicate.rs:73 ReplicationServer serving at 0.0.0.0:50051
2026-02-09T17:02:24.904157+09:00  INFO replited::database::database::init: init.rs:94 Creating meta dir at: "/Users/cypark/Documents/project/replited/./.data.db-replited/"
2026-02-09T17:02:24.904171+09:00 DEBUG replited::database::database::init: init.rs:121 Database::try_create meta_dir: ./.data.db-replited/
2026-02-09T17:02:24.904182+09:00  INFO replited::database::database::init: init.rs:172 Acquiring read lock
2026-02-09T17:02:24.904463+09:00 DEBUG replited::database::database::init: init.rs:177 db data.db cannot determine last wal position, error: SqliteInvalidWalHeaderError. Code: 122, Text = Invalid WAL frame header.

<Backtrace disabled by default. Please use RUST_BACKTRACE=1 to enable> , clearing generation
2026-02-09T17:02:25.906338+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:25.959849+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 00000000-0000-0000-0000-000000000000, generation: "" }, db_mod_time: None, wal_size: 0, shadow_wal_file: "", shadow_wal_size: 0, reason: Some("no generation exists"), restart: false }
2026-02-09T17:02:25.961054+09:00 DEBUG replited::database::database: database.rs:574 init_shadow_wal_file ./.data.db-replited/generations/019c416c5a277350a65aa8523f854040/wal/0000000000.wal
2026-02-09T17:02:25.961606+09:00 DEBUG replited::database::database: database.rs:603 create shadow wal file ./.data.db-replited/generations/019c416c5a277350a65aa8523f854040/wal/0000000000.wal
2026-02-09T17:02:25.961788+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 4152,  orig_shadow_wal_size: 32
2026-02-09T17:02:25.962506+09:00 DEBUG replited::database::database: database.rs:607 db data.db init_shadow_wal_file copy_to_shadow_wal: 4152, 4152
2026-02-09T17:02:25.963348+09:00  INFO replited::database::database: database.rs:532 db data.db retention generation 019c416c5a277350a65aa8523f854040 floor 0 tail 0 active_replicas 0
2026-02-09T17:02:25.963485+09:00  INFO replited::database::database: database.rs:202 db data.db sync new generation: 019c416c5a277350a65aa8523f854040, reason: no generation exists
2026-02-09T17:02:25.963595+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 4152,  orig_shadow_wal_size: 4152
2026-02-09T17:02:25.963724+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 4152, 4152
2026-02-09T17:02:25.963733+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 4152:4152
2026-02-09T17:02:25.963972+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:26.964580+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:26.964944+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 019c416c-5a27-7350-a65a-a8523f854040, generation: "019c416c5a277350a65aa8523f854040" }, db_mod_time: Some(SystemTime { tv_sec: 1770624144, tv_nsec: 847180209 }), wal_size: 8272, shadow_wal_file: "./.data.db-replited/generations/019c416c5a277350a65aa8523f854040/wal/0000000000.wal", shadow_wal_size: 4152, reason: None, restart: false }
2026-02-09T17:02:26.965324+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 8272,  orig_shadow_wal_size: 4152
2026-02-09T17:02:26.965894+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 8272, 8272
2026-02-09T17:02:26.965904+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 8272:8272
2026-02-09T17:02:26.966061+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
2026-02-09T17:02:27.933861+09:00  INFO replited::database::database::init: init.rs:94 Creating meta dir at: "/Users/cypark/Documents/project/replited/./.data.db-replited/"
2026-02-09T17:02:27.933996+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 8272,  orig_shadow_wal_size: 8272
2026-02-09T17:02:27.934001+09:00 DEBUG replited::database::database::checkpoint: checkpoint.rs:74 db data.db do_checkpoint copy_to_shadow_wal: 8272, 8272
2026-02-09T17:02:27.934334+09:00 DEBUG replited::database::database::checkpoint: checkpoint.rs:104 db data.db do_checkpoint after checkpoint copy_to_shadow_wal: 8272, 8272
2026-02-09T17:02:27.934345+09:00 DEBUG replited::database::database: database.rs:574 init_shadow_wal_file ./.data.db-replited/generations/019c416c5a277350a65aa8523f854040/wal/0000000001.wal
2026-02-09T17:02:27.934453+09:00 DEBUG replited::database::database: database.rs:603 create shadow wal file ./.data.db-replited/generations/019c416c5a277350a65aa8523f854040/wal/0000000001.wal
2026-02-09T17:02:27.934483+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 8272,  orig_shadow_wal_size: 32
2026-02-09T17:02:27.934684+09:00 DEBUG replited::database::database: database.rs:607 db data.db init_shadow_wal_file copy_to_shadow_wal: 8272, 4152
2026-02-09T17:02:27.934774+09:00  INFO replited::database::database::snapshot: snapshot.rs:72 db data.db snapshot created, pos: WalGenerationPos { generation: Generation { uuid: 019c416c-5a27-7350-a65a-a8523f854040, generation: "019c416c5a277350a65aa8523f854040" }, index: 1, offset: 4152 }
2026-02-09T17:02:27.967398+09:00 DEBUG replited::database::database: database.rs:184 sync database: data.db
2026-02-09T17:02:27.968652+09:00 DEBUG replited::database::database: database.rs:193 db data.db sync info: SyncInfo { generation: Generation { uuid: 019c416c-5a27-7350-a65a-a8523f854040, generation: "019c416c5a277350a65aa8523f854040" }, db_mod_time: Some(SystemTime { tv_sec: 1770624147, tv_nsec: 934024544 }), wal_size: 8272, shadow_wal_file: "./.data.db-replited/generations/019c416c5a277350a65aa8523f854040/wal/0000000001.wal", shadow_wal_size: 4152, reason: None, restart: false }
2026-02-09T17:02:27.969503+09:00 DEBUG replited::database::database: database.rs:632 copy_to_shadow_wal orig_wal_size: 8272,  orig_shadow_wal_size: 4152
2026-02-09T17:02:27.972455+09:00 DEBUG replited::database::database: database.rs:339 db data.db sync_wal copy_to_shadow_wal: 4152, 4152
2026-02-09T17:02:27.972484+09:00 DEBUG replited::database::database: database.rs:218 db data.db sync_wal 4152:4152
2026-02-09T17:02:27.972696+09:00  INFO replited::database::database: database.rs:532 db data.db retention generation 019c416c5a277350a65aa8523f854040 floor 0 tail 1 active_replicas 1
2026-02-09T17:02:27.972707+09:00  INFO replited::database::database: database.rs:545 db data.db replica 019c416c61cb703eb762cf490bea4e07 lag_index 0 acked 019c416c5a277350a65aa8523f854040:1:4152 ack_age_s 0
2026-02-09T17:02:27.972804+09:00 DEBUG replited::database::database: database.rs:247 sync db data.db ok
